	LIST	P=PIC16F84A
	INCLUDE	"P16F84A.INC"
		
	__CONFIG	_HS_OSC&_WDT_OFF

CNT1	EQU	0CH
CNT2	EQU	0DH
CNT3	EQU	0EH
LED1A	EQU	0FH
LED1B	EQU	10H
LED2A	EQU	11H
LED2B	EQU	2H

	ORG	0H

MAIN	
	BSF		STATUS , RP0
	CLRF	TRISA
	CLRF	TRISB
	BCF		STATUS , RP0
	
	CLRF	LED1A
	CLRF	LED1B
	CLRF	LED2A
	CLRF	LED2B
	CALL	UPDATE
START
	CALL	TIME100M
	MOVLW	1H
	MOVWF	LED1B
	MOVLW	1H
	MOVWF	LED2B
	CLRF	LED1A
	CLRF	LED2A
	CALL	UPDATE
MAINLP1
	CALL	TIME100M
	BCF 	STATUS, C
	RLF		LED1B
	RLF		LED1A
	CALL	UPDATE

	BTFSC	LED1A, 1
	GOTO	TURN

	CALL 	TIME100M
	BCF 	STATUS, C
	RLF		LED1B
	RLF		LED1A
	BCF 	STATUS, C
	RLF		LED2B
	RLF		LED2A
	CALL	UPDATE

	GOTO 	MAINLP1
TURN
	CALL	TIME100M
	BCF 	STATUS, C
	RLF		LED2B
	RLF		LED2A
	CALL	UPDATE
MAINLP2
	BTFSC	LED1B, 0
	GOTO	START

	CALL 	TIME100M
	BCF 	STATUS, C
	RRF		LED1A
	RRF		LED1B
	CALL 	UPDATE

	BTFSC	LED1B, 0
	GOTO	START

	CALL 	TIME100M
	BCF 	STATUS, C
	RRF		LED1A
	RRF		LED1B
	BCF 	STATUS, C
	RLF		LED2B
	RLF		LED2A
	CALL	UPDATE

	GOTO 	MAINLP2
	
;50us(250c*0.2us)
TIME50U						
	MOVLW	052H		; 1c 52H = 82		
	MOVWF	CNT1		; 1c
	NOP					; 1c
	NOP					; 1c
	NOP					; 1c
LOOP1
	DECFSZ	CNT1,F		; 1*(82-1)+2*1 = 83
	GOTO	LOOP1		; 2*(82-2) = 160
	RETURN				; 2c

;5ms(25000*0.2us)	
TIME5M
	MOVLW	062H 		; 1c 62H = 98
	MOVWF 	CNT2		; 1c
	NOP					; 1c
	NOP					; 1c
	NOP					; 1c
	NOP					; 1c
	NOP					; 1c
	NOP					; 1c
	NOP					; 1c
LOOP2
	CALL 	TIME50U		; (2+250)*98 = 24696
	DECFSZ	CNT2, F		; 1*(98-1)+2*1 = 99
	GOTO	LOOP2		; 2*(98-1) = 194
	RETURN				; 2c

;100ms(20*5ms)
TIME100M
	MOVLW	014H		; 14H = 20
	MOVWF	CNT3
LOOP3
	CALL	TIME5M
	DECFSZ	CNT3, F
	GOTO 	LOOP3
	RETURN

UPDATE
	MOVF	LED1B, W
	IORWF	LED2B, W
	MOVWF	PORTB
	MOVF	LED1A, W
	IORWF	LED2A, W
	MOVWF	PORTA
	RETURN

	END